{% extends 'base.html' %}

{% block content %}
<section style="max-width:520px;margin:60px auto;padding:30px;border-radius:12px;background:rgba(2,6,23,0.6);border:2px solid rgba(14,165,233,0.3);">
    <h2 style="text-align:center;color:#0ea5e9;">
        {% if is_first_login %}
            ğŸ” Set Your Admin Password
        {% else %}
            ğŸ” Change Admin Password
        {% endif %}
    </h2>
    
    {% if success %}
        <div style="background:#b4ffb4;color:#006600;padding:15px;border-radius:6px;margin-bottom:15px;border-left:4px solid #00cc00;">
            <strong>âœ… {{ success }}</strong>
            {% if password_set %}
            <div style="background:rgba(0,0,0,0.2);padding:12px;border-radius:6px;margin-top:12px;font-family:monospace;word-break:break-all;">
                <p style="margin:0 0 5px 0;opacity:0.8;font-size:12px;">Your new password:</p>
                <code style="font-size:14px;font-weight:700;">{{ password_set }}</code>
            </div>
            <p style="margin:12px 0 0 0;font-size:12px;">
                ğŸ’¾ <strong>Save this password securely!</strong> On Render, update <code style="background:rgba(0,0,0,0.3);padding:2px 6px;border-radius:3px;">ADMIN_PASSWORD</code> environment variable.
            </p>
            {% endif %}
        </div>
    {% endif %}

    {% if error %}
        <div style="background:#ffb4b4;color:#660000;padding:15px;border-radius:6px;margin-bottom:15px;border-left:4px solid #ff0000;">
            <strong>âŒ {{ error }}</strong>
        </div>
    {% endif %}

    <form method="post">
        <div style="background:rgba(14,165,233,0.1);padding:12px;border-radius:6px;margin-bottom:15px;border-left:3px solid #0ea5e9;">
            <p style="margin:0;opacity:0.8;font-size:13px;">
                <strong>Admin Email:</strong> smartsortsolutions04@gmail.com
            </p>
        </div>

        <div style="margin-bottom:15px;">
            <label style="display:block;margin-bottom:5px;font-weight:600;">New Password</label>
            <input type="password" name="new_password" placeholder="Enter new password (min 8 characters)" required style="width:100%;padding:10px;border-radius:6px;border:1px solid rgba(255,255,255,0.2);background:rgba(255,255,255,0.05);color:#fff;box-sizing:border-box;">
            <small style="opacity:0.6;display:block;margin-top:5px;">Use a strong password with uppercase, lowercase, numbers, and symbols</small>
        </div>

        <div style="margin-bottom:15px;">
            <label style="display:block;margin-bottom:5px;font-weight:600;">Confirm Password</label>
            <input type="password" name="confirm_password" placeholder="Confirm your password" required style="width:100%;padding:10px;border-radius:6px;border:1px solid rgba(255,255,255,0.2);background:rgba(255,255,255,0.05);color:#fff;box-sizing:border-box;">
        </div>

        <button type="submit" style="width:100%;padding:12px;background:#0ea5e9;color:white;border:none;border-radius:6px;font-weight:700;cursor:pointer;transition:all 0.3s ease;margin-top:10px;">
            {% if is_first_login %}
                Set Password & Continue
            {% else %}
                Update Password
            {% endif %}
        </button>
    </form>

    <hr style="border:none;border-top:1px solid rgba(255,255,255,0.1);margin:20px 0;">
    
    <div style="background:rgba(14,165,233,0.05);padding:12px;border-radius:6px;font-size:12px;line-height:1.6;">
        <strong>ğŸ”’ Important:</strong>
        <ul style="margin:5px 0;padding-left:20px;">
            <li>Store your password securely</li>
            <li>After setting password, you'll use it for login</li>
            <li>Update Render environment to persist password</li>
            <li>Never share your password via chat</li>
        </ul>
    </div>

    {% if not success %}
    <div style="margin-top:20px;text-align:center;">
        <a href="{{ url_for('admin_logout') }}" style="color:#0ea5e9;text-decoration:none;opacity:0.8;">â† Back to Login</a>
    </div>
    {% endif %}
</section>
{% endblock %}
